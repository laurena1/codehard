{"filter":false,"title":"auth_server.js","tooltip":"/auth_server.js","undoManager":{"mark":15,"position":15,"stack":[[{"group":"doc","deltas":[{"start":{"row":8,"column":35},"end":{"row":11,"column":34},"action":"insert","lines":["","require('./models/comments_model.js');","require('./models/photo_model.js');","require('./models/page_model.js');"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":35},"end":{"row":10,"column":58},"action":"insert","lines":["","var express = require('express');","var bodyParser = require('body-parser');","var mongoose = require('mongoose');","var db = mongoose.connect('mongodb://localhost/comments');"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":9,"column":35},"action":"remove","lines":["var mongoose = require('mongoose');"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":0},"end":{"row":9,"column":0},"action":"remove","lines":["var express = require('express');","var bodyParser = require('body-parser');",""]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":35},"end":{"row":7,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":40,"column":25},"end":{"row":41,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":41,"column":33},"action":"insert","lines":["require('./comment_routes')(app);"]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":2},"end":{"row":38,"column":29},"action":"insert","lines":["app.use(bodyParser.json());"]}]}],[{"group":"doc","deltas":[{"start":{"row":38,"column":0},"end":{"row":38,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":43,"column":45},"action":"remove","lines":["var express = require('express');","var bodyParser = require('body-parser');","var cookieParser = require('cookie-parser');","","var expressSession = require('express-session');","var mongoStore = require('connect-mongo')({session: expressSession});","var mongoose = require('mongoose');","var db = mongoose.connect('mongodb://localhost/comments');","","require('./models/users_model.js');","require('./models/comments_model.js');","require('./models/photo_model.js');","require('./models/page_model.js');","","var connString = \"mongodb://\" + process.env.IP + \":27017/\";","","","console.log(connString + 'myapp');","","var conn = mongoose.connect(connString + 'myapp');","","var app = express();","","","app.engine('.html', require('ejs').__express);","app.set('views', __dirname + '/views');","app.set('view engine', 'html');","app.use(bodyParser.urlencoded({ extended: true }));","app.use(bodyParser.json());","app.use(cookieParser());","app.use(expressSession({","  secret: 'SECRET',","  cookie: {maxAge: 60*60*1000},","  store: new mongoStore({","      db: mongoose.connection.db,","      collection: 'sessions'","    })","  }));","app.use(bodyParser.json());","","require('./routes')(app);","require('./comment_routes')(app);","","app.listen(process.env.PORT, process.env.IP);"]},{"start":{"row":0,"column":0},"end":{"row":47,"column":45},"action":"insert","lines":["//we bring in all of the libraries","var express = require('express');","var bodyParser = require('body-parser');","var cookieParser = require('cookie-parser');","","//this is new, we'll use it to store authentication as a session variable","var expressSession = require('express-session');","var mongoStore = require('connect-mongo')({session: expressSession});","var mongoose = require('mongoose');","","//ensure that the User model is registered with Mongoose/MongoDB","require('./models/users_model.js');","","//a C9-oriented connection string","//make sure MongoDB is running first","var connString = \"mongodb://\" + process.env.IP + \":27017/\";","","//debug code","console.log(connString + 'myapp');","","//connect to Mongoose","var conn = mongoose.connect(connString + 'myapp');","","//initialize Express","var app = express();","","//for EJS templating","app.engine('.html', require('ejs').__express);","app.set('views', __dirname + '/views');","app.set('view engine', 'html');","app.use(bodyParser.urlencoded({ extended: true }));","app.use(bodyParser.json());","app.use(cookieParser());","app.use(expressSession({","  secret: 'SECRET',","  cookie: {maxAge: 60*60*1000},","  store: new mongoStore({","      db: mongoose.connection.db,","      collection: 'sessions'","    })","  }));","  ","//this is a call to an exported routine (using the Backbone.js system) ","//this becomes like another library, but we haven't sent it to npmjs","require('./routes')(app);","//app.listen(80);","//don't forget, we need to use the C9 variables","app.listen(process.env.PORT, process.env.IP);"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":34},"action":"remove","lines":["//we bring in all of the libraries"]}]}],[{"group":"doc","deltas":[{"start":{"row":5,"column":0},"end":{"row":5,"column":73},"action":"remove","lines":["//this is new, we'll use it to store authentication as a session variable"]},{"start":{"row":10,"column":0},"end":{"row":10,"column":64},"action":"remove","lines":["//ensure that the User model is registered with Mongoose/MongoDB"]},{"start":{"row":13,"column":0},"end":{"row":14,"column":36},"action":"remove","lines":["//a C9-oriented connection string","//make sure MongoDB is running first"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":12},"action":"remove","lines":["//debug code"]},{"start":{"row":19,"column":0},"end":{"row":19,"column":21},"action":"remove","lines":["//connect to Mongoose"]},{"start":{"row":22,"column":0},"end":{"row":22,"column":20},"action":"remove","lines":["//initialize Express"]},{"start":{"row":25,"column":0},"end":{"row":25,"column":20},"action":"remove","lines":["//for EJS templating"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":6},"end":{"row":40,"column":2},"action":"remove","lines":["","  "]},{"start":{"row":40,"column":0},"end":{"row":41,"column":68},"action":"remove","lines":["//this is a call to an exported routine (using the Backbone.js system) ","//this becomes like another library, but we haven't sent it to npmjs"]},{"start":{"row":42,"column":0},"end":{"row":43,"column":47},"action":"remove","lines":["//app.listen(80);","//don't forget, we need to use the C9 variables"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":35},"end":{"row":10,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":9,"column":35},"end":{"row":11,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":10,"column":59},"end":{"row":12,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":11,"column":34},"end":{"row":13,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":12,"column":50},"end":{"row":14,"column":0},"action":"remove","lines":["","",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""]},{"start":{"row":2,"column":44},"end":{"row":4,"column":0},"action":"remove","lines":["","",""]}]}]]},"ace":{"folds":[],"scrolltop":119,"scrollleft":0,"selection":{"start":{"row":24,"column":28},"end":{"row":24,"column":28},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":7,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1416782389000,"hash":"fff8a2b3f13f3a070db5125adacf3a97228134f9"}